{% extends 'base.html' %}
{% load static %}
{% load favorite %}
{% load i18n %}

{% block content %}
    <!-- Page Content -->
    <!-- Banner Starts Here -->
    <div class="heading-page header-text">
        <section class="page-heading">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="text-content">
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Banner Ends Here -->

    <section class="blog-posts grid-system">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <div class="all-blog-posts">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="blog-post">
                                    <div class="blog-thumb">
                                    </div>
                                    <div class="down-content">
                                        <a href=""><h4>{{ post.title }}</h4></a>
                                        <ul class="post-info">
                                            <li><a>{{ post.author }}</a></li>
                                            <li><a>{{ post.created|timesince }} {% trans 'ago' %}</a></li>
                                            <li><a>{% favorite_link post %}</a></li>
                                        </ul>
                                        {{ post.text|safe }}
                                        <div class="post-options">
                                            <div class="row">
                                                <div class="col-6">
                                                    <ul class="post-tags">
                                                        <li><i class="fa fa-tags"></i></li>
                                                        {% for cat in post.category.all %}
                                                            <li><a href="#">{{ cat.name }}</a>,</li>
                                                        {% empty %}
                                                             {% trans 'no category' %}
                                                        {% endfor %}
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="sidebar-item comments">
                                    <div class="sidebar-heading">
                                        <h2>{{ post.pcomments.count }} {% trans 'comment' %}</h2>
                                    </div>
                                    <div class="content">
                                        <ul>
                                            {% for comment in comments %}
                                                <li class="d-block">
                                                    <div class="author-thumb">
                                                    </div>
                                                    <div class="right-content">
                                                        <h4>{{ comment.author }} </h4>
                                                        <span>{{ comment.created|timesince }} پیش</span>
                                                        <p>{{ comment.body }}</p>
                                                    </div>
                                                </li>
                                                {% with replies=comment.rcomments.all %}
                                                    {% for reply in replies %}
                                                        <li class="replied" style="padding-right: 40px">
                                                            <div class="author-thumb">
                                                            </div>
                                                            <div class="right-content">
                                                                <h4>{{ reply.author }}</h4>
                                                                <span>{{ reply.created|timesince }}</span>
                                                                <p>{{ reply.body }}</p>
                                                            </div>
                                                        </li>
                                                    {% endfor %}
                                                {% endwith %}
                                                <div class="col-lg-12">
                                                    <div class="sidebar-item submit-comment">
                                                        <div class="sidebar-heading">
                                                            <h2>{% trans 'Your Reply' %}</h2>
                                                        </div>
                                                        <div class="content">
                                                            <form id="comment"
                                                                  action="{% url 'Home:reply' post.slug post.id comment.id %}"
                                                                  method="post">
                                                                <div class="row">
                                                                    {% csrf_token %}
                                                                    {{ form.as_p }}
                                                                    <input type="submit" value="{% trans 'Send' %}">
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="sidebar-item submit-comment">
                                    <div class="sidebar-heading">
                                        <h2>{% trans 'Your comment' %}</h2>
                                    </div>
                                    <div class="content">
                                        <form id="comment" action="#" method="post">
                                            <div class="row">
                                                {% csrf_token %}
                                                {{ form.as_p }}
                                                <input type="submit" value="{% trans 'Send' %}">
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="sidebar">
                        <div class="row">
                            <div class="col-lg-12">
                            </div>
                            <div class="col-lg-12">

                            </div>
                            <div class="col-lg-12">
                                 <div class="sidebar-item categories">
                                    <div class="sidebar-heading">
                                        <h2>{% trans 'Categories' %}</h2>
                                    </div>
                                    <div class="content">
                                        <ul>
                                            {% for category in categories %}
                                                <li>-<a href="{% url 'categories:detail' category.id %}">{{ category.name }}</a></li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </div>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="sidebar-item tags">
                                    <div class="sidebar-heading">
                                        <h2>{% trans 'Related Posts' %}</h2>
                                    </div>
                                    <ul>
                                        {% for rpost in rposts %}
                                            {% if not rpost.title == post.title %}
                                                <li>
                                                    <a href="{{ rpost.get_absolute_url }}">{{ rpost.title }}</a>
                                                </li>
                                            {% endif %}
                                        {% empty %}
                                            <li>{% trans 'There is no Related Post' %}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{% static 'js/favoriets.js' %}"></script>
{% endblock %}